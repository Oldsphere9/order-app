# 커피 주문 앱
## 1. 프로젝트 개요

### 1.1 프로젝트명
커피 주문 앱

### 1.2 프젝젝트 목적
사사용자가 커피 메뉴를 주문하고, 관리자가 주문을 관리할 수 있는 간단한 풀택 웹 앱

### 1.3 개발 범위
- 주문하기 화면 (메뉴 선택 및 장바구니 가능)
- 관리자 화면 (재고 관리 및 주문 상태 관리)
- 데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스택
- 프론트엔드 : HTML, CSS, 리엑트, 자바스크립트
- 백엔드 : Node.js, Express
- 데이터베이스 : PostgreSQL

## 3. 기본 사항
- 프런트엔드와 백엔드를 따로 개발
- 기본적인 웹 기술만 사용
- 소속 조직명, 사번, 이름으로 회원가입 기능은 있으나 결제 기능은 제외
- 기본적인 메뉴는 커피빈 현대자동차남양연구소점 에서 판매하는 메뉴를 웹서치 하여 구성 


## 4. 주문하기 화면 상세 요구사항

### 4.1 화면 개요
사용자가 커피 메뉴를 선택하고 주문 정보를 입력하는 메인 화면입니다. 화면은 헤더, 메뉴 선택 영역, 주문 정보 사이드바로 구성됩니다.

### 4.2 레이아웃 구조

#### 4.2.1 헤더 영역
- **위치**: 화면 최상단
- **구성 요소**:
  - **로고**: 왼쪽에 커피빈 아이콘과 "커피빈 주문 시스템" 텍스트 표시
  - **탭 메뉴**: 중앙에 두 개의 탭
    - "주문하기" 탭: 현재 선택된 화면 (활성화 상태 - 밝은 회색 배경, 진한 테두리)
    - "주문 현황" 탭: 비활성화 상태 (다른 화면으로 이동)

#### 4.2.2 메인 콘텐츠 영역 (메뉴 선택)
- **위치**: 화면 왼쪽/중앙 영역
- **제목**: "메뉴 선택" (커피 컵 아이콘 포함)
- **부제목**: "원하는 메뉴를 선택해주세요"
- **카테고리 탭**:
  - 가로로 배치된 4개의 탭: "전체", "커피", "논커피", "디저트"
  - 선택된 탭: 검은색 배경, 흰색 텍스트
  - 비선택 탭: 기본 스타일
  - 클릭 시 해당 카테고리의 메뉴만 필터링하여 표시
- **메뉴 아이템 그리드**:
  - 2열 그리드 레이아웃
  - 각 메뉴 아이템 카드 구성:
    - 메뉴 이름 (예: "카페 아메리카노")
    - 카테고리 라벨 (예: "커피")
    - 가격 정보 (예: "4,500원~")
    - "+ 옵션 선택" 버튼

#### 4.2.3 사이드바 영역 (주문 정보)
- **위치**: 화면 오른쪽
- **제목**: "주문 정보" (쇼핑 카트 아이콘 포함)
- **입력 필드**:
  1. **팀 선택**
     - 라벨: "팀 선택"
     - 드롭다운 입력 필드
     - 플레이스홀더: "팀을 선택하세요"
     - 드롭다운 화살표 아이콘 포함
  2. **이름**
     - 라벨: "이름"
     - 텍스트 입력 필드
     - 플레이스홀더: "이름을 입력하세요"
  3. **사원번호**
     - 라벨: "사원번호"
     - 텍스트 입력 필드
     - 플레이스홀더: "사원번호를 입력하세요"
  4. **추천 메뉴** (조건부 표시)
     - 라벨: "자주 주문한 메뉴"
     - 주문 인원 정보(팀, 이름, 사원번호)가 모두 입력되고 해당 인원의 이전 주문 이력이 있는 경우에만 표시
     - 최대 3개의 추천 메뉴를 카드 형태로 표시
     - 각 추천 메뉴 카드 구성:
       - 메뉴 이름
       - 카테고리 라벨
       - 기본 가격 정보
       - "추가하기" 버튼
     - 추천 메뉴 클릭 시 해당 메뉴가 장바구니에 추가됨 (옵션 선택 모달은 표시하지 않고 기본 옵션으로 추가)
  5. **선택한 메뉴**
     - 라벨: "선택한 메뉴"
     - 메뉴가 선택되지 않은 경우: "메뉴를 선택해주세요" 플레이스홀더 표시
     - 메뉴가 선택된 경우: 선택된 메뉴 목록 표시

### 4.3 기능 요구사항

#### 4.3.1 메뉴 선택 기능
- **카테고리 필터링**:
  - 카테고리 탭 클릭 시 해당 카테고리의 메뉴만 표시
  - "전체" 탭 선택 시 모든 메뉴 표시
  - 선택된 카테고리 탭은 시각적으로 구분 (검은색 배경, 흰색 텍스트)
- **메뉴 옵션 선택**:
  - "+ 옵션 선택" 버튼 클릭 시 옵션 선택 모달/화면 표시
  - 옵션 선택 완료 시 해당 메뉴가 "선택한 메뉴" 영역에 추가됨
  - 동일 메뉴를 여러 번 선택 가능 (수량 관리)

#### 4.3.2 주문 정보 입력 기능
- **팀 선택**:
  - 드롭다운에서 팀 목록 선택
  - 필수 입력 항목
- **이름 입력**:
  - 텍스트 입력 필드에 이름 입력
  - 필수 입력 항목
- **사원번호 입력**:
  - 텍스트 입력 필드에 사원번호 입력
  - 필수 입력 항목
- **선택한 메뉴 관리**:
  - 선택한 메뉴 목록 표시
  - 각 메뉴별 수량 조절 기능
  - 메뉴 삭제 기능
  - 총 주문 금액 계산 및 표시

#### 4.3.3 메뉴 추천 기능
- **추천 메뉴 조회**:
  - 주문 인원 정보(팀, 이름, 사원번호)가 모두 입력되면 자동으로 추천 메뉴 조회 API 호출
  - 해당 인원의 이전 주문 이력이 있는 경우에만 추천 메뉴 표시
  - 추천 메뉴는 주문 횟수가 많은 순서로 최대 3개까지 표시
  - 추천 메뉴는 판매 중(`sale_status: active`)인 메뉴만 표시
- **추천 메뉴 선택**:
  - 추천 메뉴 카드의 "추가하기" 버튼 클릭 시 해당 메뉴가 장바구니에 추가됨
  - 추천 메뉴는 기본 옵션(Regular, 기본 샷, 추가 옵션 없음)으로 추가됨
  - 온도 옵션은 메뉴 타입에 따라 자동 설정 (아이스/스무디/설향/스파클링 메뉴는 ICE, 그 외는 HOT)
  - 추가된 메뉴는 일반 메뉴와 동일하게 수량 조절 및 삭제 가능

#### 4.3.4 주문 제출 기능
- 주문 정보 입력 완료 후 주문 제출 버튼 활성화
- 필수 입력 항목(팀, 이름, 사원번호) 및 메뉴 선택 검증
- 주문 제출 시 주문 데이터 저장 및 확인
- 주문 저장 성공 시 해당 인원의 메뉴 선호도 정보 자동 업데이트

### 4.4 UI/UX 요구사항

#### 4.4.1 디자인 스타일
- **색상**: 주로 흰색과 밝은 회색 톤 사용
- **레이아웃**: 깔끔하고 모던한 디자인
- **타이포그래피**: 한글 폰트 사용, 가독성 고려

#### 4.4.2 인터랙션
- **탭 전환**: 부드러운 전환 애니메이션
- **버튼 호버**: 마우스 오버 시 시각적 피드백
- **입력 필드 포커스**: 포커스 시 명확한 시각적 표시
- **로딩 상태**: 메뉴 로딩 중 로딩 인디케이터 표시

#### 4.4.3 반응형 디자인
- 데스크톱 환경 최적화
- 화면 크기에 따른 레이아웃 조정 고려

### 4.5 데이터 요구사항

#### 4.5.1 메뉴 데이터
- 메뉴 ID
- 메뉴 이름
- 카테고리 (커피, 논커피, 디저트)
- 기본 가격
- 옵션 정보 (사이즈, 샷 추가, 시럽 등)

#### 4.5.2 팀 데이터
- 팀 ID
- 팀 이름

#### 4.5.3 주문 데이터 (임시 저장)
- 선택한 메뉴 목록 (메뉴 ID, 옵션, 수량)
- 팀 정보
- 이름
- 사원번호
- 총 주문 금액

### 4.6 예외 처리
- 메뉴 로딩 실패 시 에러 메시지 표시
- 필수 입력 항목 미입력 시 주문 제출 불가 및 안내 메시지
- 네트워크 오류 시 사용자에게 알림

## 5. 주문현황 화면 상세 요구사항

### 5.1 화면 개요
모든 주문 내역을 조회하고 팀별 주문 현황을 확인할 수 있는 대시보드 형태의 화면입니다. 전체 주문 통계와 팀별 상세 주문 내역을 제공합니다.

### 5.2 레이아웃 구조

#### 5.2.1 헤더 영역
- **위치**: 화면 최상단
- **구성 요소**:
  - **로고**: 왼쪽에 커피빈 아이콘과 "커피빈 주문 시스템" 텍스트 표시
  - **탭 메뉴**: 중앙에 두 개의 탭
    - "주문하기" 탭: 비활성화 상태 (주문하기 화면으로 이동)
    - "주문 현황" 탭: 현재 선택된 화면 (활성화 상태 - 밝은 회색 배경, 테두리)

#### 5.2.2 전체 주문 통계 섹션
- **위치**: 헤더 바로 아래, 가로로 배치된 3개의 통계 카드
- **구성 요소**:
  1. **전체 주문 수량 카드**
     - 아이콘: 리스트 아이콘
     - 제목: "전체 주문 수량"
     - 값: 주문된 메뉴의 총 개수 (예: "4 개")
  2. **참여 팀 수 카드**
     - 아이콘: 두 명의 사람 실루엣 아이콘
     - 제목: "참여 팀 수"
     - 값: 주문에 참여한 팀의 총 개수 (예: "2 팀")
  3. **총 주문 금액 카드**
     - 아이콘: 원화 기호 아이콘
     - 제목: "총 주문 금액"
     - 값: 모든 주문의 총 금액 (예: "26,000 원")

#### 5.2.3 팀별 주문 현황 섹션
- **위치**: 통계 섹션 아래, 메인 콘텐츠 영역
- **제목**: "팀별 주문 현황"
- **구성**: 각 팀별로 카드 형태의 컨테이너로 구분하여 표시
- **팀별 카드 구성**:
  - **팀 헤더**:
    - 왼쪽: 두 명의 사람 실루엣 아이콘과 팀 이름 (예: "개발팀", "디자인팀")
    - 오른쪽: 팀별 요약 정보
      - "총 X개" (해당 팀의 총 주문 개수)
      - "X원" (해당 팀의 총 주문 금액)
  - **주문 내역 테이블**:
    - 테이블 컬럼:
      - **메뉴명**: 주문된 메뉴의 이름 (예: "카페 아메리카노")
      - **옵션**: 선택된 옵션 정보 (예: "ICE, Regular, +1샷")
      - **수량**: 주문 수량 (예: "1개")
      - **단가**: 메뉴의 단위 가격 (예: "5,500원")
      - **금액**: 해당 주문 항목의 총 금액 (예: "5,500원")
      - **주문 일시**: 주문이 입력된 날짜와 시간 (예: "2024-01-15 14:30")
    - 각 주문 항목은 테이블의 한 행으로 표시
    - 여러 주문 항목이 있는 경우 여러 행으로 표시
    - 주문 일시는 한국 시간대(KST)로 표시하며, 날짜와 시간 형식으로 표시 (예: "YYYY-MM-DD HH:mm")

### 5.3 기능 요구사항

#### 5.3.1 통계 조회 기능
- **전체 주문 수량 계산**:
  - 모든 팀의 주문 항목 수량을 합산하여 표시
  - 실시간으로 업데이트
- **참여 팀 수 계산**:
  - 주문이 있는 팀의 개수를 집계하여 표시
  - 중복 제거하여 계산
- **총 주문 금액 계산**:
  - 모든 주문 항목의 금액을 합산하여 표시
  - 통화 형식으로 표시 (예: "26,000 원")

#### 5.3.2 팀별 주문 현황 조회 기능
- **팀 목록 표시**:
  - 주문이 있는 모든 팀을 카드 형태로 표시
  - 팀별로 구분하여 표시
- **팀별 요약 정보**:
  - 각 팀의 총 주문 개수 계산 및 표시
  - 각 팀의 총 주문 금액 계산 및 표시
- **주문 상세 내역 표시**:
  - 각 팀의 모든 주문 항목을 테이블 형태로 표시
  - 메뉴명, 옵션, 수량, 단가, 금액 정보 포함
  - 옵션 정보는 쉼표로 구분하여 표시 (예: "ICE, Grande, +1샷")

#### 5.3.3 데이터 갱신 기능
- 주문이 추가되거나 수정될 때 실시간으로 화면 갱신
- 통계 정보와 팀별 주문 현황이 자동으로 업데이트

#### 5.3.4 정렬 및 필터링 기능 (선택 사항)
- 팀별 정렬 옵션 (이름순, 주문 금액순 등)
- 특정 팀만 필터링하여 조회

### 5.4 UI/UX 요구사항

#### 5.4.1 디자인 스타일
- **색상**: 주로 흰색과 밝은 회색 톤 사용 (주문하기 화면과 일관성 유지)
- **레이아웃**: 대시보드 형태의 깔끔한 디자인
- **카드 디자인**: 통계 카드와 팀별 카드는 명확한 구분선과 여백 사용
- **테이블 디자인**: 가독성을 위한 적절한 행 간격과 컬럼 정렬

#### 5.4.2 인터랙션
- **탭 전환**: 부드러운 전환 애니메이션
- **카드 호버**: 마우스 오버 시 시각적 피드백 (선택 사항)
- **로딩 상태**: 데이터 로딩 중 로딩 인디케이터 표시
- **빈 상태 처리**: 주문이 없는 경우 적절한 안내 메시지 표시

#### 5.4.3 반응형 디자인
- 데스크톱 환경 최적화
- 화면 크기에 따른 레이아웃 조정 고려
- 테이블이 작은 화면에서는 스크롤 가능하도록 처리

### 5.5 데이터 요구사항

#### 5.5.1 통계 데이터
- 전체 주문 수량: 숫자 (정수)
- 참여 팀 수: 숫자 (정수)
- 총 주문 금액: 숫자 (정수, 원 단위)

#### 5.5.2 팀별 주문 데이터
- 팀 ID
- 팀 이름
- 팀별 총 주문 개수
- 팀별 총 주문 금액
- 주문 항목 목록:
  - 메뉴 ID
  - 메뉴 이름
  - 옵션 정보 (온도, 사이즈, 추가 옵션 등)
  - 수량
  - 단가
  - 금액 (단가 × 수량)

#### 5.5.3 데이터 집계
- 서버에서 주문 데이터를 집계하여 전달
- 클라이언트에서 추가 계산 최소화

### 5.6 예외 처리
- 주문 데이터 로딩 실패 시 에러 메시지 표시
- 주문이 없는 경우 "주문 내역이 없습니다" 메시지 표시
- 네트워크 오류 시 사용자에게 알림 및 재시도 옵션 제공
- 데이터 형식 오류 시 안전하게 처리

## 6. 백엔드 개발 요구사항

### 6.1 데이터 모델

#### 6.1.1 Menus (메뉴)
메뉴 정보를 저장하는 테이블입니다.

**필드:**
- `id` (Primary Key): 메뉴 고유 ID
- `name` (String): 메뉴 이름 (예: "카페 아메리카노")
- `description` (String): 메뉴 설명
- `category` (String): 카테고리 (커피, 논커피, 디저트)
- `base_price` (Integer): 기본 가격 (원 단위)
- `sale_status` (String): 판매 상태
  - `active`: 판매 중
  - `season_off`: 시즌 오프 (판매 중지)
- `created_at` (Timestamp): 생성 일시
- `updated_at` (Timestamp): 수정 일시

#### 6.1.2 Options (옵션)
메뉴 옵션 정보를 저장하는 테이블입니다.

**필드:**
- `id` (Primary Key): 옵션 고유 ID
- `name` (String): 옵션 이름 (예: "Grande", "+1샷", "휘핑크림 추가")
- `option_type` (String): 옵션 타입 (temperature, size, shot, extra)
- `price` (Integer): 옵션 추가 가격 (원 단위)
- `menu_id` (Foreign Key): 연결된 메뉴 ID (NULL일 경우 모든 메뉴에 적용 가능)
- `created_at` (Timestamp): 생성 일시
- `updated_at` (Timestamp): 수정 일시

#### 6.1.3 Members (주문 인원)
주문한 인원 정보를 저장하는 테이블입니다.

**필드:**
- `id` (Primary Key): 멤버 고유 ID
- `team` (String): 팀 이름 (예: "개발팀", "디자인팀")
- `name` (String): 이름
- `employee_id` (String): 사원번호
- `created_at` (Timestamp): 생성 일시
- `updated_at` (Timestamp): 수정 일시

**제약 조건:**
- 동일한 사원번호(`employee_id`)로 중복 주문 시 최신 주문 정보로 업데이트

#### 6.1.4 Orders (주문)
주문 내용을 저장하는 테이블입니다.

**필드:**
- `id` (Primary Key): 주문 고유 ID
- `member_id` (Foreign Key): 주문 인원 ID (Members 테이블 참조)
- `menu_id` (Foreign Key): 메뉴 ID (Menus 테이블 참조)
- `quantity` (Integer): 주문 수량
- `options` (JSON): 선택한 옵션 정보
  - `temperature`: 온도 (HOT, ICE)
  - `size`: 사이즈 (Small, Regular, Large)
  - `shot`: 샷 추가 (기본, +1샷, +2샷)
  - `extra`: 추가 옵션 (휘핑크림 추가, 시럽 추가 등)
- `unit_price` (Integer): 단위 가격 (원 단위)
- `total_price` (Integer): 총 금액 (원 단위)
- `created_at` (Timestamp): 주문 입력 일시 (주문이 생성된 날짜와 시간, 자동 저장)
- `updated_at` (Timestamp): 수정 일시 (주문 정보가 수정된 날짜와 시간)

**주문 날짜/시간 저장 규칙:**
- 주문이 생성될 때 `created_at` 필드에 현재 서버 시간이 자동으로 저장됩니다.
- `created_at`은 주문 입력 날짜와 시간을 나타내며, 주문 현황 조회 시 정렬 및 필터링에 사용됩니다.
- 동일 주문 인원(`employee_id`)의 중복 주문이 있는 경우, `created_at`이 최신인 주문만 조회됩니다.

#### 6.1.5 MemberMenuPreferences (주문 인원별 메뉴 선호도)
주문 인원별로 자주 주문한 메뉴 정보를 집계하여 저장하는 테이블입니다. 메뉴 추천 기능에 사용됩니다.

**필드:**
- `id` (Primary Key): 선호도 고유 ID
- `member_id` (Foreign Key): 주문 인원 ID (Members 테이블 참조)
- `menu_id` (Foreign Key): 메뉴 ID (Menus 테이블 참조)
- `order_count` (Integer): 해당 메뉴 주문 횟수 (기본값: 0)
- `last_ordered_at` (Timestamp): 마지막 주문 일시
- `created_at` (Timestamp): 생성 일시
- `updated_at` (Timestamp): 수정 일시

**제약 조건:**
- `member_id`와 `menu_id`의 조합은 유니크 (동일 인원이 동일 메뉴를 여러 번 주문해도 하나의 레코드로 관리)
- 주문이 발생할 때마다 `order_count` 증가 및 `last_ordered_at` 업데이트

### 6.2 데이터 스키마를 위한 사용자 흐름

#### 6.2.1 메뉴 조회 및 표시
1. 사용자가 '주문하기' 메뉴를 클릭합니다.
2. 프론트엔드에서 `GET /api/menus` API를 호출합니다.
3. 백엔드는 데이터베이스의 `Menus` 테이블에서 `sale_status`가 `active`인 메뉴만 조회합니다.
4. 조회된 메뉴 정보를 프론트엔드에 전달합니다.
5. 프론트엔드는 받은 메뉴 정보를 화면에 표시합니다.
6. `sale_status`가 `season_off`인 메뉴는 '메뉴 관리' 화면에만 표시됩니다.

#### 6.2.2 메뉴 관리 (Season Off 처리)
1. 관리자가 '메뉴 관리' 메뉴를 클릭합니다.
2. 프론트엔드에서 `GET /api/menus?status=season_off` API를 호출합니다.
3. 백엔드는 데이터베이스의 `Menus` 테이블에서 `sale_status`가 `season_off`인 메뉴를 조회합니다.
4. 조회된 메뉴 목록을 프론트엔드에 전달합니다.
5. 관리자가 season off 메뉴를 선택하고 판매 상태를 변경합니다.
6. 프론트엔드에서 `PATCH /api/menus/:id` API를 호출하여 메뉴 정보를 업데이트합니다.
7. 백엔드는 `Menus` 테이블의 해당 메뉴 정보를 업데이트합니다.
   - `sale_status`를 `active` 또는 `season_off`로 변경
   - `updated_at` 필드 업데이트

#### 6.2.3 메뉴 선택 및 장바구니
1. 사용자가 메뉴를 선택하고 옵션을 설정합니다.
2. 선택한 메뉴 정보는 프론트엔드의 장바구니(임시 저장)에 추가됩니다.
3. 장바구니에 선택한 메뉴 목록이 표시됩니다.
4. 사용자는 장바구니에서 수량을 조절하거나 메뉴를 삭제할 수 있습니다.

#### 6.2.4 주문 제출
1. 사용자가 장바구니에서 '주문하기' 버튼을 클릭합니다.
2. 프론트엔드에서 주문 정보를 검증합니다.
   - 필수 입력 항목 확인 (팀, 이름, 사원번호)
   - 메뉴 선택 여부 확인
   - Season off 메뉴 주문 시도 시 에러 처리
3. 프론트엔드에서 `POST /api/orders` API를 호출합니다.
4. 백엔드는 다음 순서로 데이터를 저장합니다:
   a. `Members` 테이블에 주문 인원 정보 저장 또는 업데이트
      - 동일한 `employee_id`가 존재하는 경우 기존 레코드 업데이트
      - 존재하지 않는 경우 새 레코드 생성
   b. `Orders` 테이블에 주문 내용 저장
      - 각 메뉴 항목별로 주문 레코드 생성
      - `member_id`는 위에서 저장/업데이트한 Members의 ID 사용
      - `created_at` 필드에 현재 서버 시간(주문 입력 날짜와 시간)이 자동으로 저장됨
      - `updated_at` 필드는 초기에는 `created_at`과 동일한 값으로 설정됨
5. 저장 완료 후 성공 응답을 프론트엔드에 전달합니다.
   - 응답에는 저장된 주문의 `created_at` 정보가 포함될 수 있습니다.

#### 6.2.5 주문 현황 조회
1. 사용자가 '주문 현황' 메뉴를 클릭합니다.
2. 프론트엔드에서 `GET /api/orders` API를 호출합니다.
3. 백엔드는 다음 정보를 조회합니다:
   - `Members` 테이블과 `Orders` 테이블을 JOIN하여 주문 정보 조회
   - 동일 주문 인원(`employee_id`)의 중복 주문이 있는 경우 최신 주문 정보만 반환
   - 팀별로 그룹화하여 주문 내역 집계
4. 조회된 주문 정보를 프론트엔드에 전달합니다.
5. 프론트엔드는 받은 정보를 화면에 표시합니다.
   - 전체 주문 수량, 참여 팀 수, 총 주문 금액 통계
   - 팀별 주문 현황 테이블

#### 6.2.6 주문 인원별 주문 조회
1. 사용자가 주문 인원 정보(팀, 이름, 사원번호)를 입력합니다.
2. 프론트엔드에서 `GET /api/orders?team={team}&name={name}&employee_id={employee_id}` API를 호출합니다.
3. 백엔드는 `Members` 테이블에서 해당 조건에 맞는 멤버를 조회합니다.
4. 조회된 멤버의 `member_id`를 사용하여 `Orders` 테이블에서 주문 내역을 조회합니다.
5. 조회된 주문 정보를 프론트엔드에 전달합니다.

#### 6.2.7 메뉴 추천 기능
1. 사용자가 주문 인원 정보(팀, 이름, 사원번호)를 입력합니다.
2. 프론트엔드에서 `GET /api/members/recommendations?team={team}&name={name}&employee_id={employee_id}` API를 호출합니다.
3. 백엔드는 다음 순서로 처리합니다:
   a. `Members` 테이블에서 입력된 정보로 멤버를 조회합니다.
   b. 멤버가 존재하는 경우:
      - `MemberMenuPreferences` 테이블에서 해당 `member_id`의 메뉴 선호도 정보를 조회합니다.
      - `order_count`가 높은 순서로 정렬하여 상위 N개(기본 3개) 메뉴를 선택합니다.
      - 동일한 `order_count`인 경우 `last_ordered_at`이 최신인 메뉴를 우선합니다.
      - 선택된 메뉴의 `sale_status`가 `active`인 메뉴만 필터링합니다.
   c. 멤버가 존재하지 않는 경우:
      - 빈 배열을 반환합니다.
4. 조회된 추천 메뉴 목록을 프론트엔드에 전달합니다.
5. 프론트엔드는 추천 메뉴를 사이드바에 표시합니다.
6. 사용자가 추천 메뉴를 클릭하면 해당 메뉴가 장바구니에 추가됩니다.

#### 6.2.8 주문 발생 시 선호도 업데이트
1. 사용자가 주문을 제출합니다 (`POST /api/orders`).
2. 백엔드에서 주문이 성공적으로 저장된 후:
   a. 각 주문 항목에 대해 `MemberMenuPreferences` 테이블을 확인합니다.
   b. 해당 `member_id`와 `menu_id` 조합의 레코드가 존재하는 경우:
      - `order_count`를 1 증가시킵니다.
      - `last_ordered_at`을 현재 시간으로 업데이트합니다.
      - `updated_at`을 현재 시간으로 업데이트합니다.
   c. 레코드가 존재하지 않는 경우:
      - 새로운 레코드를 생성합니다.
      - `order_count`를 1로 설정합니다.
      - `last_ordered_at`을 현재 시간으로 설정합니다.
3. 선호도 업데이트는 주문 저장과 동일한 트랜잭션 내에서 처리됩니다.

### 6.3 API 설계

#### 6.3.1 메뉴 관련 API

**GET /api/menus**
- **설명**: 판매 중인 메뉴 목록을 조회합니다.
- **쿼리 파라미터**:
  - `category` (선택): 카테고리 필터 (커피, 논커피, 디저트)
  - `status` (선택): 판매 상태 필터 (active, season_off)
- **응답**:
  ```json
  [
    {
      "id": 1,
      "name": "카페 아메리카노",
      "description": "진한 에스프레소에 물을 더한 커피",
      "category": "커피",
      "base_price": 4500,
      "sale_status": "active",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  ]
  ```

**GET /api/menus/:id**
- **설명**: 특정 메뉴의 상세 정보를 조회합니다.
- **응답**: 메뉴 객체

**PATCH /api/menus/:id**
- **설명**: 메뉴 정보를 업데이트합니다 (주로 판매 상태 변경).
- **요청 본문**:
  ```json
  {
    "sale_status": "active" | "season_off"
  }
  ```
- **응답**: 업데이트된 메뉴 객체

#### 6.3.2 옵션 관련 API

**GET /api/options**
- **설명**: 옵션 목록을 조회합니다.
- **쿼리 파라미터**:
  - `menu_id` (선택): 특정 메뉴에 연결된 옵션만 조회
  - `option_type` (선택): 옵션 타입 필터 (temperature, size, shot, extra)
- **응답**:
  ```json
  [
    {
      "id": 1,
      "name": "Grande",
      "option_type": "size",
      "price": 500,
      "menu_id": null,
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-01T00:00:00Z"
    }
  ]
  ```

#### 6.3.3 주문 관련 API

**POST /api/orders**
- **설명**: 새로운 주문을 생성합니다.
- **요청 본문**:
  ```json
  {
    "team": "개발팀",
    "name": "홍길동",
    "employee_id": "E001",
    "menus": [
      {
        "menu_id": 1,
        "quantity": 1,
        "options": {
          "temperature": "ICE",
          "size": "Grande",
          "shot": "+1샷",
          "extra": ""
        }
      }
    ]
  }
  ```
- **검증**:
  - 필수 필드 검증 (team, name, employee_id, menus)
  - 메뉴의 `sale_status`가 `season_off`인 경우 에러 반환
  - 옵션 가격 계산 및 총 금액 계산
- **응답**:
  ```json
  {
    "success": true,
    "message": "주문이 완료되었습니다.",
    "order_id": 123
  }
  ```
- **에러 응답** (Season off 메뉴 주문 시도):
  ```json
  {
    "success": false,
    "error": "Season off 메뉴로 주문이 안됩니다.",
    "menu_name": "카페 아메리카노"
  }
  ```

**GET /api/orders**
- **설명**: 주문 목록을 조회합니다.
- **쿼리 파라미터**:
  - `team` (선택): 팀 이름 필터
  - `name` (선택): 이름 필터
  - `employee_id` (선택): 사원번호 필터
- **응답**:
  ```json
  [
    {
      "member": {
        "id": 1,
        "team": "개발팀",
        "name": "홍길동",
        "employee_id": "E001"
      },
      "orders": [
        {
          "id": 1,
          "menu": {
            "id": 1,
            "name": "카페 아메리카노",
            "category": "커피"
          },
          "quantity": 1,
          "options": {
            "temperature": "ICE",
            "size": "Regular",
            "shot": "+1샷",
            "extra": ""
          },
          "unit_price": 5500,
          "total_price": 5500,
          "created_at": "2024-01-15T14:30:00Z",
          "updated_at": "2024-01-15T14:30:00Z"
        }
      ]
    }
  ]
  ```
- **응답 필드 설명**:
  - `created_at`: 주문이 입력된 날짜와 시간 (ISO 8601 형식, UTC 시간대)
  - `updated_at`: 주문 정보가 마지막으로 수정된 날짜와 시간
  - 프론트엔드에서는 `created_at`을 한국 시간대(KST)로 변환하여 표시해야 합니다.

**GET /api/orders/stats**
- **설명**: 주문 통계 정보를 조회합니다.
- **응답**:
  ```json
  {
    "total_quantity": 4,
    "team_count": 2,
    "total_amount": 26000
  }
  ```

#### 6.3.5 메뉴 추천 관련 API

**GET /api/members/recommendations**
- **설명**: 주문 인원 정보를 기반으로 자주 주문한 메뉴를 추천합니다.
- **쿼리 파라미터**:
  - `team` (필수): 팀 이름
  - `name` (필수): 이름
  - `employee_id` (필수): 사원번호
  - `limit` (선택): 추천 메뉴 개수 (기본값: 3, 최대: 5)
- **응답**:
  ```json
  [
    {
      "id": 1,
      "name": "카페 아메리카노",
      "description": "진한 에스프레소에 물을 더한 커피",
      "category": "커피",
      "base_price": 4500,
      "sale_status": "active",
      "order_count": 5,
      "last_ordered_at": "2024-01-15T10:30:00Z"
    },
    {
      "id": 2,
      "name": "카페라떼",
      "description": "에스프레소와 스팀 밀크",
      "category": "커피",
      "base_price": 5000,
      "sale_status": "active",
      "order_count": 3,
      "last_ordered_at": "2024-01-14T14:20:00Z"
    }
  ]
  ```
- **에러 응답** (멤버를 찾을 수 없는 경우):
  ```json
  {
    "success": false,
    "error": "주문 이력이 없습니다.",
    "code": "NO_ORDER_HISTORY"
  }
  ```
- **비즈니스 로직**:
  - 입력된 정보로 `Members` 테이블에서 멤버 조회
  - 멤버가 존재하는 경우 `MemberMenuPreferences` 테이블에서 해당 멤버의 선호도 정보 조회
  - `order_count` 내림차순, `last_ordered_at` 내림차순으로 정렬
  - `sale_status`가 `active`인 메뉴만 필터링
  - `limit` 파라미터에 따라 상위 N개 메뉴 반환
  - 멤버가 존재하지 않거나 주문 이력이 없는 경우 빈 배열 반환

#### 6.3.4 에러 처리

**공통 에러 응답 형식:**
```json
{
  "success": false,
  "error": "에러 메시지",
  "code": "ERROR_CODE"
}
```

**주요 에러 코드:**
- `MENU_NOT_FOUND`: 메뉴를 찾을 수 없음
- `MENU_SEASON_OFF`: Season off 메뉴는 주문할 수 없음
- `INVALID_INPUT`: 잘못된 입력 데이터
- `DATABASE_ERROR`: 데이터베이스 오류
- `INTERNAL_ERROR`: 서버 내부 오류

### 6.4 데이터베이스 관계

#### 6.4.1 테이블 관계도
```
Menus (1) ──< (N) Options
  │
  │ (1)              (1)
  │                  │
  └──< (N) Orders    │
        │            │
        │ (N)        │
        │            │
        └──> (1) Members
              │
              │ (1)
              │
              └──< (N) MemberMenuPreferences
                    │
                    │ (N)
                    │
                    └──> (1) Menus
```

#### 6.4.2 주요 제약 조건
- `Orders.member_id`는 `Members.id`를 참조 (Foreign Key)
- `Orders.menu_id`는 `Menus.id`를 참조 (Foreign Key)
- `Options.menu_id`는 `Menus.id`를 참조 (Foreign Key, NULL 허용)
- `MemberMenuPreferences.member_id`는 `Members.id`를 참조 (Foreign Key)
- `MemberMenuPreferences.menu_id`는 `Menus.id`를 참조 (Foreign Key)
- `Members.employee_id`는 유니크 제약 조건 (동일 사원번호 중복 방지)
- `MemberMenuPreferences` 테이블의 `member_id`와 `menu_id` 조합은 유니크 제약 조건
- 동일 `employee_id`로 주문 시 기존 `Members` 레코드 업데이트 후 새로운 `Orders` 레코드 생성
- 주문 발생 시 `MemberMenuPreferences` 테이블의 해당 레코드 업데이트 또는 생성

### 6.5 비즈니스 로직

#### 6.5.1 주문 처리 로직
1. 주문 요청 수신
2. 메뉴 유효성 검증 (존재 여부, 판매 상태 확인)
3. 옵션 가격 계산
4. 총 금액 계산
5. Members 테이블에서 `employee_id`로 기존 멤버 조회
   - 존재하는 경우: 해당 멤버 정보 업데이트 (팀, 이름)
   - 존재하지 않는 경우: 새 멤버 생성
6. Orders 테이블에 주문 항목 저장
7. 각 주문 항목에 대해 MemberMenuPreferences 테이블 업데이트
   - 해당 `member_id`와 `menu_id` 조합의 레코드 조회
   - 존재하는 경우: `order_count` 증가, `last_ordered_at` 및 `updated_at` 업데이트
   - 존재하지 않는 경우: 새 레코드 생성 (`order_count: 1`, `last_ordered_at: 현재 시간`)
8. 성공 응답 반환

#### 6.5.2 주문 조회 로직
1. 쿼리 파라미터에 따라 필터링 조건 설정
2. Members와 Orders 테이블 JOIN
3. 동일 `employee_id`의 중복 주문이 있는 경우 최신 주문만 반환
4. 팀별로 그룹화하여 집계
5. 통계 정보 계산 (전체 주문 수량, 참여 팀 수, 총 주문 금액)
6. 결과 반환

#### 6.5.3 Season Off 메뉴 처리
- `sale_status`가 `season_off`인 메뉴는 주문하기 화면에 표시되지 않음
- Season off 메뉴를 주문하려고 시도할 경우 에러 메시지 반환
- 메뉴 관리 화면에서만 Season off 메뉴 조회 및 상태 변경 가능

#### 6.5.4 메뉴 추천 로직
1. 주문 인원 정보(팀, 이름, 사원번호) 수신
2. Members 테이블에서 해당 정보로 멤버 조회
3. 멤버가 존재하는 경우:
   - MemberMenuPreferences 테이블에서 해당 `member_id`의 모든 레코드 조회
   - `order_count` 내림차순, `last_ordered_at` 내림차순으로 정렬
   - `sale_status`가 `active`인 메뉴만 필터링
   - 상위 N개(기본 3개) 메뉴 선택
4. 멤버가 존재하지 않거나 주문 이력이 없는 경우:
   - 빈 배열 반환
5. 추천 메뉴 목록 반환 